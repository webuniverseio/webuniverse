<!doctype html> <html lang="en" class="no-js"> <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"> <meta http-equiv="x-dns-prefetch-control" content="on"> <link rel="dns-prefetch" href="//webuniverse.disqus.com"> <link rel="dns-prefetch" href="//a.disquscdn.com"> <link rel="dns-prefetch" href="//disqus.com"> <link rel="dns-prefetch" href="//glitter-services.disqus.com"> <link rel="dns-prefetch" href="//referrer.disqus.com"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@webuniverseio"> <meta property="og:url" content="http://webuniverse.io/manage-project-dependencies-with-simple-installer/index.html"> <meta name="twitter:url" content="http://webuniverse.io/manage-project-dependencies-with-simple-installer/index.html"> <meta property="og:title" content="Manage project dependencies with simple-installer | Web Universe"> <meta name="twitter:title" content="Manage project dependencies with simple-installer | Web Universe"> <meta property="og:site_name" content="Web Universe"> <meta property="og:type" content="article"> <meta property="article:publisher" content="https://www.facebook.com/webuniverseio"> <meta property="article:published_time" content="2015-04-05T10:52:22-04:00"> <meta name="description" content="Download and/or install programs in similar manner to chocolatey or similar installation managers."> <meta property="og:description" content="Download and/or install programs in similar manner to chocolatey or similar installation managers."> <meta name="twitter:description" content="Download and/or install programs in similar manner to chocolatey or similar installation managers."> <meta property="og:image" content="http://webuniverse.io/manage-project-dependencies-with-simple-installer/image.png"> <meta name="twitter:image" content="http://webuniverse.io/manage-project-dependencies-with-simple-installer/image.png"> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta name="format-detection" content="telephone=no"> <meta charset="utf-8"> <!--[if lte IE 8]><meta http-equiv="refresh" content="0;URL='https://browser-update.org/update.html'" /><![endif]--> <title>Manage project dependencies with simple-installer | Web Universe</title> <script>document.documentElement.className=document.documentElement.className.replace("no-js",""),document.createElement("picture");</script><link rel="canonical" href="http://webuniverse.io/manage-project-dependencies-with-simple-installer/index.html"> <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"> <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"> <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"> <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"> <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"> <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"> <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"> <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"> <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"> <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192"> <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160"> <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"> <meta name="msapplication-TileColor" content="#2b5797"> <meta name="msapplication-TileImage" content="/mstile-144x144.png"> <link rel="alternative" href="/atom.xml" title="Web Universe" type="application/atom+xml"> <link rel="stylesheet" href="/static/dest/css/main.v1.1.2.css"> </head></html> <body itemscope itemtype="http://schema.org/WebPage"> <meta itemprop="typicalAgeRange" content="17-"> <div id="page__wrapper"> <div id="page__layout-base"> <header id="page__header" role="banner"> <a href="/"> <h1 class="logo" itemprop="name"> Web <span class="logo__universe">Universe</span> </h1> </a> </header> <div id="page-content__wrapper"> <div id="page-content"> <div id="top-bar" class="ov-h"> <nav class="navigation decorate-links-on-hover column" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"> <h2 class="a11y__element">Main navigation</h2> <a href="#page-content__main" class="a11y__skip navigation__skip">skip navigation</a> <a href="/" itemprop="url"> <span itemprop="name">Home</span></a> <span class="navigation__separator"></span> <a href="/about/" itemprop="url"> <span itemprop="name">About</span></a> <span class="navigation__separator"></span> <a href="/projects/" itemprop="url"> <span itemprop="name">Projects</span></a> <span class="navigation__separator"></span> <a href="/recommended/" itemprop="url"> <span itemprop="name">Recommended</span></a> <span class="navigation__separator"></span> <a href="/contact/" itemprop="url"> <span itemprop="name">Contact</span></a> </nav> <div class="column"> <section> <h3 class="a11y__element">Search panel</h3> <div class="gcse-search" style="height:33px"></div> </section> </div> </div> <main id="page-content__main" tabindex="0" class="page-content__side-padding ov-h"> <div class="article" itemscope itemtype="http://schema.org/Article" id="post-manage-project-dependencies-with-simple-installer" class="article"> <article class="content-entry" itemprop="articleBody"> <div class="article__image-wrapper"> <picture> <!--[if IE 9]><video style="display: none;"><![endif]--> <source srcset="image.png" media="(min-width: 600px)"> <!--[if IE 9]></video><![endif]--> <img srcset="imageSmall.png" alt="Manage project dependencies with simple-installer"> </source></picture> </div> <h1 itemprop="name" class="article__title">Manage project dependencies with simple-installer</h1> <time class="datetime" datetime="2015-04-05T14:52:22.000Z" itemprop="datePublished"> 05 April, 2015 </time> <meta itemprop="datePublished" content="2011-05-08T19:30"> <p>In this article you’re going to learn about a program installation manager similar to <a href="https://chocolatey.org/" target="_blank" rel="external">chocolatey</a> or <code>apt-get</code>, which is running on node.js. It is called <a href="https://github.com/szarouski/SimpleInstaller" target="_blank" rel="external"><code>SimpleInstaller</code></a> and it can also work as a downloader and a task runner. We’re going to look at a few simple usage examples and then we’re going to see how SimpleInstaller can be integrated into project setup workflow, to bring new members of the team up to speed. </p> <h2 id="Top_level_highlights">Top level highlights</h2><ul> <li>is crossplatform (tested on windows and debian)</li> <li>downloads files (optional) and runs commands</li> <li>skips already installed programs</li> <li>could be used as a simple task runner</li> <li>could work as a downloader</li> <li>simple and because of that flexible and expendable <a href="https://github.com/szarouski/SimpleInstaller#api" target="_blank" rel="external">api</a></li> <li>tested with 100% coverage</li> <li>uses harmony mode for generators and <code>npm co</code> to manage execution flow</li> </ul> <h2 id="Example:_Installing_git_on_Debian">Example: Installing git on Debian</h2><p>Lets take a look at how it can be used to install a program. Here it installs git via <code>apt-get</code> on debian:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> co = <span class="built_in">require</span>(<span class="string">'co'</span>);</span><br><span class="line"><span class="keyword">var</span> SimpleInstaller = <span class="built_in">require</span>(<span class="string">'simple-installer'</span>);</span><br><span class="line"></span><br><span class="line">co(<span class="function"><span class="keyword">function</span>* <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">new</span> SimpleInstaller(&#123;</span><br><span class="line">        prefix: <span class="string">'apt-get install '</span>,</span><br><span class="line">        name: <span class="string">'git'</span></span><br><span class="line">    &#125;).run();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p> <p>Since SimpleInstaller is using generators, it is <a href="/asynchronous-programming-with-ES6-generators-promises-and-npm-co/">recommended</a> to use npm modules like <code>co</code> to keep asynchronous code in a synchronous / maintainable manner.</p> <h2 id="Example:_Installing_ruby_on_Windows">Example: Installing ruby on Windows</h2><p>This example downloads ruby and installs it on Windows:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> co = <span class="built_in">require</span>(<span class="string">'co'</span>);</span><br><span class="line"><span class="keyword">var</span> SimpleInstaller = <span class="built_in">require</span>(<span class="string">'simple-installer'</span>);</span><br><span class="line"></span><br><span class="line">co(<span class="function"><span class="keyword">function</span>* <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> installer = <span class="keyword">new</span> SimpleInstaller(&#123;</span><br><span class="line">        link: <span class="string">'https://dl.bintray.com/oneclick/rubyinstaller/rubyinstaller-2.2.1-x64.exe?direct'</span>,</span><br><span class="line">        name: <span class="string">'ruby'</span>,</span><br><span class="line">        postfix: <span class="string">' /verysilent /dir="c:\\Ruby2" /tasks="assocfiles,modpath"'</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">yield</span> installer.run();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p> <p>Fortunately rubyinstaller has command line interface which supports <code>/verysilent</code> mode - which allows us to install a program without a single popup.</p> <h2 id="Example:_Batch_installation">Example: Batch installation</h2><div style="text-align:center;margin-top:1em"><a href="simple-installer.gif"><img src="simple-installer.gif" alt="Installation process"></a></div> <p>When we setup a new machine for a new team member, or when we start on a project developed by another company, we need to install all dependencies which are required for project to build and run. Those could be node modules, ruby gems, git repositories, bower components, etc… Lets take a look at how we could use SimpleInstaller to make project dependencies installation as simple as possible.</p> <p>First we’re going to create a module <code>config.js</code>, which exports an array of program <code>info</code> objects, which are required to build and run our project:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = [&#123;</span><br><span class="line">    link: <span class="string">'https://dl.bintray.com/oneclick/rubyinstaller/rubyinstaller-2.2.1-x64.exe?direct'</span>,</span><br><span class="line">    name: <span class="string">'ruby'</span>,</span><br><span class="line">    postfix: <span class="string">' /verysilent /dir="c:\\Ruby2" /tasks="assocfiles,modpath"'</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    link: <span class="string">'http://github.com/msysgit/msysgit/releases/download/'</span> +</span><br><span class="line">    <span class="string">'Git-1.9.4-preview20140929/Git-1.9.4-preview20140929.exe'</span>,</span><br><span class="line">    name: <span class="string">'git.exe'</span>,</span><br><span class="line">    postfix: <span class="string">' /DIR="c:\\Git" /VERYSILENT /NORESTART /NOCANCEL /SP- /CLOSEAPPLICATIONS /RESTARTAPPLICATIONS /NOICONS '</span> +</span><br><span class="line">    <span class="string">'/COMPONENTS="icons,ext\\reg\\shellhere,assoc,assoc_sh" /LOADINF="'</span> + path.resolve(__dirname, <span class="string">'git.inf'</span>) + <span class="string">'"'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    prefix: <span class="string">'npm i '</span>,</span><br><span class="line">    name: <span class="string">'karma'</span>,</span><br><span class="line">    postfix: <span class="string">'-cli -g'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    prefix: <span class="string">'npm i '</span>,</span><br><span class="line">    name: <span class="string">'grunt'</span>,</span><br><span class="line">    postfix: <span class="string">'-cli -g'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    prefix: <span class="string">'npm i '</span>,</span><br><span class="line">    name: <span class="string">'bower'</span>,</span><br><span class="line">    postfix: <span class="string">' -g'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    prefix: <span class="string">'SET PATH=%PATH%;c:\\Ruby2\\bin&amp;&amp;gem install '</span>,</span><br><span class="line">    name: <span class="string">'compass'</span>,</span><br><span class="line">    postfix: <span class="string">' -v 1.0.1'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    prefix: <span class="string">'echo '</span>,</span><br><span class="line">    name: <span class="string">'bower_components'</span>,</span><br><span class="line">    postfix: <span class="string">'&amp;&amp;SET PATH=%PATH%;c:\\Git\\bin\\&amp;&amp;bower install'</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure></p> <p>Here we can see that project requires a few global node packages, along with git, ruby and compass gem. As a final step it also runs <code>bower install</code> to install client side dependencies.</p> <p>Next we need to create a module <code>installer.js</code> which will contain installation logic:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> co = <span class="built_in">require</span>(<span class="string">'co'</span>); <span class="comment">//use co and lodash to simplify code</span></span><br><span class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">'lodash'</span>);</span><br><span class="line"><span class="keyword">var</span> SimpleInstaller = <span class="built_in">require</span>(<span class="string">'simple-installer'</span>);</span><br><span class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'./config'</span>); <span class="comment">//our config</span></span><br><span class="line"></span><br><span class="line">co(<span class="function"><span class="keyword">function</span>* <span class="title">runCoroutine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//first we convert array of objects to array of generators</span></span><br><span class="line">    <span class="keyword">var</span> setup = _.map(config, <span class="function"><span class="keyword">function</span>* <span class="title">runInstaller</span><span class="params">(info)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> installer = <span class="keyword">new</span> SimpleInstaller(info);</span><br><span class="line">        <span class="keyword">yield</span> installer.run();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//then iterate and run installers, one at a time</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, length = setup.length; i &lt; length; i++) &#123;</span><br><span class="line">        <span class="keyword">yield</span> setup[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Installation finished'</span>.yellow);</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> <span class="params">(ex)</span> </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">throwUnhandledException</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'setup failed'</span>.red);</span><br><span class="line">        <span class="built_in">console</span>.log((ex.message ? ex.message : ex).red);</span><br><span class="line">        <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p> <p>And finally we need to find a good place to run installer.js. I like using it in package.json postinstall script:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"preinstall"</span>: <span class="string">"npm cache clean"</span>,</span><br><span class="line">    <span class="string">"postinstall"</span>: <span class="string">"node --harmony installer.js&amp;&amp;npm shrinkwrap --dev"</span>,</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p> <p>That way, after <code>npm install</code>, once we get all node_modules, we can run our installer, which in turn will install all missing dependencies.</p> <div id="disqus_thread"></div> </article> </div> <script>var disqus_shortname="webuniverse";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script></main><footer id="page__footer" role="contentinfo"> All content, unless otherwise indicated, <span class="nowrap"> is licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank" rel="license">CC BY 4.0</a>. </span><br> <span itemscope itemtype="http://schema.org/Person" itemprop="author"> <a href="/about" itemprop="url"> <span itemprop="name">Sergey Zarouski</span></a> </span> &copy; <span itemprop="copyrightYear">2015</span>. </footer> </div> </div> </div> </div> <script>window.WebFontConfig={google:{families:["Slabo+27px"]}},function(){var t=document.createElement("script");t.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1.5.10/webfont.js",t.type="text/javascript",t.async="true";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}();</script><script src="/bower_components/picturefill/dist/picturefill.min.js" async></script><script>!function(){var t="014578715170147478038:jt5g2str_f0",e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https:":"http:")+"//www.google.com/cse/cse.js?cx="+t;var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(e,c)}();</script><script>!function(e,n,a,t,o,c,s){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=n.createElement(a),s=n.getElementsByTagName(a)[0],c.async=1,c.src=t,s.parentNode.insertBefore(c,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),window.ga("create","UA-57969778-1","auto"),window.ga("send","pageview");</script><noscript><div class="noscript"> Javascript is disabled for this site in your browser. Please enable it if you want to see site in more interactive mode. To learn how click <a class="noscript-text--alternative" href="http://www.youtube.com/watch?v=0w8wr8a0r2M" target="_blank">here</a> or <a class="noscript-text--alternative" href="http://www.google.ca/search?q=how+to+enable+javascript&amp;tbs=vid:1" target="_blank">here</a>. </div></noscript> </body> 