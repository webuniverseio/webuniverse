{"data":{"mdx":{"fileAbsolutePath":"/app/src/content/posts/manage-project-dependencies-with-simple-installer/index.mdx","code":{"body":"function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nconst layoutProps = {};\nreturn class MDXContent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.layout = null;\n  }\n\n  render() {\n    const _this$props = this.props,\n          {\n      components\n    } = _this$props,\n          props = _objectWithoutProperties(_this$props, [\"components\"]);\n\n    return React.createElement(MDXTag, {\n      name: \"wrapper\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `In this article you're going to learn about a program installation manager similar to `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://chocolatey.org/\"\n      }\n    }, `chocolatey`), ` or `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"p\"\n    }, `apt-get`), `, which is running on node.js. It is called `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://github.com/szarouski/SimpleInstaller\"\n      }\n    }, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"a\"\n    }, `SimpleInstaller`)), ` and it can also work as a downloader and a task runner. We're going to look at a few simple usage examples and then we're going to see how SimpleInstaller can be integrated into project setup workflow, to bring new members of the team up to speed.`), React.createElement(MDXTag, {\n      name: \"h2\",\n      components: components\n    }, `Top level highlights`), React.createElement(MDXTag, {\n      name: \"ul\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `is crossplatform (tested on windows and debian)`), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `downloads files (optional) and runs commands`), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `skips already installed programs`), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `could be used as a simple task runner`), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `could work as a downloader`), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `simple and because of that flexible and extendable `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"li\",\n      props: {\n        \"href\": \"https://github.com/szarouski/SimpleInstaller#api\"\n      }\n    }, `api`)), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `tested with 100% coverage`), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `uses harmony mode for generators and `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"li\"\n    }, `npm co`), ` to manage execution flow`)), React.createElement(MDXTag, {\n      name: \"h2\",\n      components: components\n    }, `Example: Installing git on Debian`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Lets take a look at how it can be used to install a program. Here it installs git via `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"p\"\n    }, `apt-get`), ` on debian:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-js\"\n      }\n    }, `var co = require('co');\nvar SimpleInstaller = require('simple-installer');\n\nco(function* () {\n    yield new SimpleInstaller({\n        prefix: 'apt-get install ',\n        name: 'git'\n    }).run();\n});\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Since SimpleInstaller is using generators, it is `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"/asynchronous-programming-with-ES6-generators-promises-and-npm-co/\"\n      }\n    }, `recommended`), ` to use npm modules like `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"p\"\n    }, `co`), ` to keep asynchronous code in a synchronous / maintainable manner.`), React.createElement(MDXTag, {\n      name: \"h2\",\n      components: components\n    }, `Example: Installing ruby on Windows`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `This example downloads ruby and installs it on Windows:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-js\"\n      }\n    }, `var co = require('co');\nvar SimpleInstaller = require('simple-installer');\n\nco(function* () {\n    var installer = new SimpleInstaller({\n        link: 'https://dl.bintray.com/oneclick/rubyinstaller/rubyinstaller-2.2.1-x64.exe?direct',\n        name: 'ruby',\n        postfix: ' /verysilent /dir=\"c:\\\\Ruby2\" /tasks=\"assocfiles,modpath\"'\n    });\n    yield installer.run();\n});\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Fortunately rubyinstaller has command line interface which supports `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"p\"\n    }, `/verysilent`), ` mode - which allows us to install a program without a single popup.`), React.createElement(MDXTag, {\n      name: \"h2\",\n      components: components\n    }, `Example: Batch installation`), React.createElement(\"div\", {\n      style: {\n        \"textAlign\": \"center\",\n        \"marginTop\": \"1em\"\n      }\n    }, React.createElement(\"img\", {\n      src: img,\n      alt: \"Installation process\"\n    })), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `When we setup a new machine for a new team member, or when we start on a project developed by another company, we need to install all dependencies which are required for project to build and run. Those could be node modules, ruby gems, git repositories, bower components, etc... Lets take a look at how we could use SimpleInstaller to make project dependencies installation as simple as possible.`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `First we're going to create a module `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"p\"\n    }, `config.js`), `, which exports an array of program `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"p\"\n    }, `info`), ` objects, which are required to build and run our project:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-js\"\n      }\n    }, `'use strict';\n\nvar path = require('path');\n\nmodule.exports = [{\n    link: 'https://dl.bintray.com/oneclick/rubyinstaller/rubyinstaller-2.2.1-x64.exe?direct',\n    name: 'ruby',\n    postfix: ' /verysilent /dir=\"c:\\\\Ruby2\" /tasks=\"assocfiles,modpath\"'\n},\n{\n    link: 'http://github.com/msysgit/msysgit/releases/download/' +\n    'Git-1.9.4-preview20140929/Git-1.9.4-preview20140929.exe',\n    name: 'git.exe',\n    postfix: ' /DIR=\"c:\\\\Git\" /VERYSILENT /NORESTART /NOCANCEL /SP- /CLOSEAPPLICATIONS /RESTARTAPPLICATIONS /NOICONS ' +\n    '/COMPONENTS=\"icons,ext\\\\reg\\\\shellhere,assoc,assoc_sh\" /LOADINF=\"' + path.resolve(__dirname, 'git.inf') + '\"'\n}, {\n    prefix: 'npm i ',\n    name: 'karma',\n    postfix: '-cli -g'\n}, {\n    prefix: 'npm i ',\n    name: 'grunt',\n    postfix: '-cli -g'\n}, {\n    prefix: 'npm i ',\n    name: 'bower',\n    postfix: ' -g'\n}, {\n    prefix: 'SET PATH=%PATH%;c:\\\\Ruby2\\\\bin&&gem install ',\n    name: 'compass',\n    postfix: ' -v 1.0.1'\n}, {\n    prefix: 'echo ',\n    name: 'bower_components',\n    postfix: '&&SET PATH=%PATH%;c:\\\\Git\\\\bin\\\\&&bower install'\n}];\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Here we can see that project requires a few global node packages, along with git, ruby and compass gem. As a final step it also runs `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"p\"\n    }, `bower install`), ` to install client side dependencies.`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Next we need to create a module `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"p\"\n    }, `installer.js`), ` which will contain installation logic:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-js\"\n      }\n    }, `'use strict';\n\nvar co = require('co'); //use co and lodash to simplify code\nvar _ = require('lodash');\nvar SimpleInstaller = require('simple-installer');\nvar config = require('./config'); //our config\n\nco(function* runCoroutine() {\n    //first we convert array of objects to array of generators\n    var setup = _.map(config, function* runInstaller(info) {\n        var installer = new SimpleInstaller(info);\n        yield installer.run();\n    });\n\n    //then iterate and run installers, one at a time\n    for (var i = 0, length = setup.length; i < length; i++) {\n        yield setup[i];\n    }\n\n    console.log('Installation finished'.yellow);\n}).catch(function (ex) {\n    setTimeout(function throwUnhandledException() {\n        console.log('setup failed'.red);\n        console.log((ex.message ? ex.message : ex).red);\n        throw ex;\n    }, 0);\n});\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `And finally we need to find a good place to run installer.js. I like using it in package.json postinstall script:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-js\"\n      }\n    }, `{\n  \"scripts\": {\n    \"preinstall\": \"npm cache clean\",\n    \"postinstall\": \"node --harmony installer.js&&npm shrinkwrap --dev\",\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n  }\n}\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `That way, after `, React.createElement(MDXTag, {\n      name: \"inlineCode\",\n      components: components,\n      parentName: \"p\"\n    }, `npm install`), `, once we get all node_modules, we can run our installer, which in turn will install all missing dependencies.`));\n  }\n\n}"},"frontmatter":{"title":"Manage project dependencies with simple-installer","image":{"publicURL":"/static/image-77373695269ecb1e5dd92d7df2dcd998.png"},"imageSmall":{"publicURL":"/static/imageSmall-94751d11cc51e6031955774fda354d94.png"},"overview":"Download and/or install programs in similar manner to chocolatey or similar installation managers.","copyright":null,"date":"2015-04-05T10:52:22.000Z","dateFormatted":"05 April, 2015"},"fields":{"slug":"/manage-project-dependencies-with-simple-installer/"}}},"pageContext":{"slug":"/manage-project-dependencies-with-simple-installer/"}}